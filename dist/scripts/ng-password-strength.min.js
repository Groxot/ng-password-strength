!function(){"use strict";angular.module("ngPasswordStrength",[]).directive("ngPasswordStrength",function(){return{template:'<div class="progress {{valueClass.outter}}"><div class="{{valueClass.inner}} {{innerClass}}" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="100" ng-style="{width : ( value + \'%\' ) }"><span class="sr-only">{{value}}%</span></div></div>',restrict:"A",require:"ngModel",scope:{pwd:"=ngPasswordStrength",value:"=strength",minStrengthPersentage:"=?",minNumberAmount:"=?",minUpperAmount:"=?",minLowerAmount:"=?",minSymbolAmount:"=?",innerClassPrefix:"@?",outterClassPrefix:"@?",innerClass:"@?",mode:"=?"},link:function(e,n,s,r){var o={foundation:{innerClass:"meter"},bootstrap:{innerClass:"progress-bar",innerClassPrefix:"progress-bar-"}},t=function(n){var s,r,o,t,u=function(e){for(var n=e.length-1,s="";n>=0;s+=e[n--]);return s},a={pos:{},neg:{}},m={pos:{},neg:{seqLetter:0,seqNumber:0,seqSymbol:0}},l=0,i="abcdefghijklmnopqrstuvwxyz",p="01234567890",g="\\!@#$%&/()=?Â¿";if(e.minStrengthPersentage||(e.minStrengthPersentage=0),e.minNumberAmount||(e.minNumberAmount=0),e.minUpperAmount||(e.minUpperAmount=0),e.minLowerAmount||(e.minLowerAmount=0),e.minSymbolAmount||(e.minSymbolAmount=0),n){for(a.pos.lower=n.match(/[a-z]/g),a.pos.upper=n.match(/[A-Z]/g),a.pos.numbers=n.match(/\d/g),a.pos.symbols=n.match(/[~!@#$%^&*()_+-={}|\[\]\\:\";'<>?,./]/g),a.pos.middleNumber=n.slice(1,-1).match(/\d/g),a.pos.middleSymbol=n.slice(1,-1).match(/[$-/:-?{-~!^_`\[\]]/g),m.pos.lower=a.pos.lower?a.pos.lower.length:0,m.pos.upper=a.pos.upper?a.pos.upper.length:0,m.pos.numbers=a.pos.numbers?a.pos.numbers.length:0,m.pos.symbols=a.pos.symbols?a.pos.symbols.length:0,e.cntNmb=m.pos.numbers,e.cntUpp=m.pos.upper,e.cntLwr=m.pos.lower,e.cntSmb=m.pos.symbols,s=_.reduce(m.pos,function(e,n){return e+Math.min(1,n)},0),m.pos.numChars=n.length,s+=m.pos.numChars>=8?1:0,m.pos.requirements=s>=3?s:0,m.pos.middleNumber=a.pos.middleNumber?a.pos.middleNumber.length:0,m.pos.middleSymbol=a.pos.middleSymbol?a.pos.middleSymbol.length:0,a.neg.consecLower=n.match(/(?=([a-z]{2}))/g),a.neg.consecUpper=n.match(/(?=([A-Z]{2}))/g),a.neg.consecNumbers=n.match(/(?=(\d{2}))/g),a.neg.onlyNumbers=n.match(/^[0-9]*$/g),a.neg.onlyLetters=n.match(/^([a-z]|[A-Z])*$/g),a.neg.onlySymbols=a.pos.symbols&&a.pos.symbols.length===m.pos.numChars?!0:!1,m.neg.consecLower=a.neg.consecLower?a.neg.consecLower.length:0,m.neg.consecUpper=a.neg.consecUpper?a.neg.consecUpper.length:0,m.neg.consecNumbers=a.neg.consecNumbers?a.neg.consecNumbers.length:0,t=0;t<i.length-2;t++){var c=n.toLowerCase();o=i.substring(t,parseInt(t+3)),r=u(o),(-1!==c.indexOf(o)||-1!==c.indexOf(r))&&m.neg.seqLetter++}for(t=0;t<p.length-2;t++)o=p.substring(t,parseInt(t+3)),r=u(o),(-1!==n.indexOf(o)||-1!==n.toLowerCase().indexOf(r))&&m.neg.seqNumber++;for(t=0;t<g.length-2;t++)o=g.substring(t,parseInt(t+3)),r=u(o),(-1!==n.indexOf(o)||-1!==n.toLowerCase().indexOf(r))&&m.neg.seqSymbol++;m.neg.repeated=_.chain(n.toLowerCase().split("")).countBy(function(e){return e}).reject(function(e){return 1===e}).reduce(function(e,n){return e+n},0).value(),l+=4*m.pos.numChars,m.pos.upper&&(l+=2*(m.pos.numChars-m.pos.upper)),m.pos.lower&&(l+=2*(m.pos.numChars-m.pos.lower)),(m.pos.upper||m.pos.lower)&&(l+=4*m.pos.numbers),l+=6*m.pos.symbols,l+=2*(m.pos.middleSymbol+m.pos.middleNumber),l+=2*m.pos.requirements,l-=2*m.neg.consecLower,l-=2*m.neg.consecUpper,l-=2*m.neg.consecNumbers,l-=3*m.neg.seqNumber,l-=3*m.neg.seqLetter,l-=3*m.neg.seqSymbol,a.neg.onlyNumbers&&(l-=m.pos.numChars),a.neg.onlyLetters&&(l-=m.pos.numChars),a.neg.onlySymbols&&(l-=7*m.pos.numChars),m.neg.repeated&&(l-=m.neg.repeated/m.pos.numChars*10)}return Math.max(0,Math.min(100,Math.round(l)))},u=function(n){return 30>n?{inner:e.innerClassPrefix+"danger",outter:e.outterClassPrefix+"danger"}:n>=30&&50>n?{outter:e.outterClassPrefix+"warning",inner:e.innerClassPrefix+"warning"}:n>=50?{outter:e.outterClassPrefix+"success",inner:e.innerClassPrefix+"success"}:void 0};e.innerClassPrefix=e.innerClassPrefix||"",e.outterClassPrefix=e.outterClassPrefix||"",e.$watch("mode",function(){angular.extend(e,o[e.mode]),e.valueClass=u(e.value)}),e.$watch("pwd",function(){e.value=t(e.pwd),e.valueClass=u(e.value),e.$parent.$parent.strengthValue=e.value,r.$validate()}),r.$validators.ngPasswordStrengthPersentage=function(){return e.value>=e.minStrengthPersentage},r.$validators.ngPasswordStrengthUpperAmount=function(){return e.minUpperAmount<=e.cntUpp},r.$validators.ngPasswordStrengthLowerAmount=function(){return e.minLowerAmount<=e.cntLwr},r.$validators.ngPasswordStrengthNumberAmount=function(){return e.minNumberAmount<=e.cntNmb},r.$validators.ngPasswordStrengthSymbolAmount=function(){return e.minSymbolAmount<=e.cntSmb}}}})}();